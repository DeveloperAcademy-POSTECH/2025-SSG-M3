
> [!question]Blender에서 AR용 3D 캐릭터 제작 및 애니메이션 시스템 구축
## 프로젝트 개요

이번 Challenge 5의 목표는 Blender와 Reality Composer Pro를 활용해 제작한 3D 에셋을 RealityKit에서 물리 효과와 사용자 입력 처리를 포함한 애니메이션 캐릭터로 구현하는 것이다. 단순히 모델링만 하는 것이 아니라, AR 환경에서 실제로 동작하는 인터랙티브한 캐릭터를 만드는 전 과정을 다룬다.

## 1. Blender 3D 슬라임 캐릭터 제작

### 투명 질감 표현을 위한 노멀 처리
![[Screenshot 2025-08-17 at 11.34.09 PM.png]]
슬라임의 투명한 질감을 표현하기 위해 노멀의 방향을 뒤집는 기법을 사용한다. **Shift + N**을 통해 노멀을 재계산할 수 있다. 이 작업은 왜 중요할까?
![[Screenshot 2025-08-17 at 11.34.55 PM.png]]
3D에서 면의 방향성을 결정하는 노멀 벡터가 잘못 설정되면, 광원 계산이나 투명도 처리가 부자연스럽게 나타날 수 있다. 특히 슬라임처럼 반투명한 재질의 경우, 노멀 방향이 렌더링 결과에 직접적인 영향을 미친다.

### 모델링 과정에서 발생한 문제점

정면에서는 자연스럽게 보이지만, 다른 각도에서 보면 각 요소가 따로 떨어져 있는 듯한 이질감이 발생했다. 이는 흔히 발생하는 문제로, 개별 요소들이 메인 오브젝트의 곡면에 제대로 붙지 않았기 때문이다.

**원인 분석**: 슬라임의 눈, 눈썹, 볼 등의 얼굴 요소들이 단순히 위에 올려진 상태로, 실제 얼굴 곡면의 형태를 따르지 못하고 있었다.

## 2. 얼굴 요소 정렬 문제 해결

### Lattice와 Shrinkwrap을 활용한 솔루션

얼굴 요소들을 자연스럽게 곡면에 맞춰 배치하기 위해 두 가지 핵심 기능을 조합해서 사용한다.

#### Lattice 적용하기
![[Screenshot 2025-08-17 at 11.38.21 PM.png]]
```
1. 얼굴 요소들을 동시에 변형 & 적용시키기 위해 Lattice를 생성
```
![[Screenshot 2025-08-17 at 11.38.56 PM.png]]
```
2. 레티스를 부모로 설정
   - 여러 요소 동시 선택 시, 레티스를 반드시 마지막에 클릭 후 적용
   - Command + P로 부모 설정
```
![[image.png]]
![[Screenshot 2025-08-14 at 10.21.29 AM.png]]
![[Screenshot 2025-08-14 at 10.35.34 AM.png]]
```
3. 해상도 변경으로 래티스의 분할/세그먼트 수 조절
   - 해당 축 방향으로 더 많은 제어점 생성
   - 더 국소적인 변형 가능
```

**Lattice의 핵심 개념**: Lattice는 3D 격자 구조로, 내부에 있는 오브젝트들을 격자점의 움직임에 따라 변형시킨다. 마치 투명한 상자 안에 있는 물체들을 상자를 비틀어서 함께 변형시키는 것과 같은 원리다.

#### Shrinkwrap으로 곡면에 밀착시키기

Shrinkwrap는 선택한 오브젝트를 다른 표면에 "밀착"시키는 역할을 한다.

```
Modifier > 수축 감싸기(Shrinkwrap) > 대상 > 붙일 물체 선택
```

![[Screenshot 2025-08-14 at 10.37.38 AM.png]]
![[Screenshot 2025-08-14 at 10.38.02 AM.png]]


![[Screenshot 2025-08-14 at 10.42.15 AM.png]]
![[Screenshot 2025-08-14 at 10.43.00 AM.png]]
붙혀봤는데, 볼이 예상과다르게 붙는다!..

하지만 여기서 중요한 설정이 하나 더 있다. **Wrap Mode** 설정이다.

### Wrap Mode의 차이점 이해

처음에 볼이 예상과 다르게 붙는 문제가 발생했는데, 이는 Wrap Mode 설정 때문이었다.

**Nearest Surface Point 모드의 문제점**:

- 각 버텍스가 자기 기준으로 가장 가까운 표면을 찾음
- 곡면에서 서로 다른 버텍스들이 각자 다른 방향으로 끌려감
- 결과적으로 얼굴 요소들이 찌그러지고 비틀려 보임

**Project 모드의 장점**:

- 버텍스들이 같은 투사 방향으로 이동
- 원래 요소 형태가 유지된 채 곡면에 부드럽게 붙음
- 특히 "노멀 방향 투사"는 표면 곡률에 맞춰 자연스럽게 밀착
![[image (2).png]]

## 3. 애니메이션 시스템 구축

슬라임 캐릭터의 애니메이션은 두 가지 접근 방식으로 관리한다.

### Shape Key를 통한 표정 관리

표정의 미묘한 변화는 Shape Key로 처리한다. 이는 버텍스 레벨에서의 변형을 키프레임으로 저장하는 방식이다.

```
- 기본 상태: Basic
- 표정 1: Key 1
- 표정 2: Key 2...
```
![[Screen Recording 2025-08-14 at 8.14.15 PM.mov]]
각 Shape Key는 0.0부터 1.0까지의 값으로 제어되며, 블렌딩을 통해 자연스러운 표정 전환이 가능하다.

### Armature를 통한 바디 애니메이션

통통 튀는 움직임같은 전신 동작은 **Armature**로 구현한다. Armature는 3D 모델을 움직이게 해주는 뼈대 시스템이다.

#### Armature 설정 과정

```
1. 변환 오리엔테이션을 글로벌로 설정
2. Shift + A > Armature 추가
3. Parent 설정 (중요한 순서):
   - 슬라임 메시 선택
   - Shift 누르고 Armature 선택
   - Ctrl + P → "자동 웨이트와 함께(With Automatic Weights)" 선택
```

**자동 웨이트의 의미**: Armature의 각 본(Bone)에 따라 메시가 자동으로 Weight Paint가 적용된다. 이는 뼈가 움직일 때 메시의 어느 부분이 얼마나 영향을 받을지를 결정하는 가중치다.

#### 애니메이션 키프레임 설정

뼈대를 선택하고 **Location, Rotation & Scale**을 한 번에 키프레임으로 설정한다. 이렇게 하는 이유는 무엇일까?

- 위치/회전/크기 변화를 한 번에 기록하므로 움직임이 더 자연스러움
- 애니메이션 데이터 관리가 효율적
- 나중에 수정할 때도 일관성 있게 처리 가능
![[slime_jump.mov]]
## 4. 최종 결과물

통통 튀는 점프 애니메이션을 성공적으로 제작했다. 이 과정에서 학습한 핵심 개념들을 정리하면:
![[slime_idle+jump_.mov]]



### 핵심 학습 포인트

1. **노멀의 중요성**: 3D 그래픽에서 면의 방향성은 렌더링 품질을 좌우한다
2. **Lattice + Shrinkwrap 조합**: 복잡한 곡면에 여러 요소를 자연스럽게 배치하는 효과적인 방법
3. **Wrap Mode 이해**: 같은 기능이라도 모드 설정에 따라 결과가 완전히 달라질 수 있다
4. **애니메이션 레이어링**: 표정은 Shape Key, 바디 모션은 Armature로 분리해서 관리
5. **Weight Paint 시스템**: 뼈대 애니메이션에서 메시 변형을 제어하는 핵심 메커니즘

### 다음 단계로의 연결점

이렇게 완성된 Blender 모델은 USDZ 포맷으로 내보내져 Reality Composer Pro에서 테스트되고, 최종적으로 RealityKit 기반 iOS 앱에서 AR 환경에 배치될 예정이다.

Blender에서의 애니메이션 작업이 실제 AR 앱에서 어떻게 재생되는지, 그리고 사용자 입력에 따른 애니메이션 전환이 어떻게 구현되는지가 다음 단계의 핵심이 될 것이다.

물리엔진과의 상호작용, 터치 제스처 인식, 그리고 실시간 렌더링 최적화까지 고려해야 할 요소들이 많지만, 탄탄한 기초 모델링과 애니메이션 시스템이 구축되었기 때문에 다음 단계로 자연스럽게 이어질 수 있을 것이다.


## keywords
- [Blender, 3D모델링, 슬라임캐릭터, Armature, ShapeKey, Lattice, Shrinkwrap, 노멀벡터, WeightPaint, AR, RealityKit, USDZ] 
- [3D, 애니메이션, AR개발, iOS]

## GQ
- Normals는 무엇이며 3D 렌더링에 어떤 영향을 미치는가?
- Reality Composer Pro에서 USDZ 파일 최적화 및 물리 속성 설정
- RealityKit에서 Blender 애니메이션을 불러와 사용자 입력과 연동하는 방법
- AR 환경에서 물리엔진 충돌 처리 및 실시간 애니메이션 전환 구현


#Onething 